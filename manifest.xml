<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<OfficeApp
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
        xmlns:mailappor="http://schemas.microsoft.com/office/mailappversionoverrides"
        xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
        xsi:type="MailApp">

    <Id>c8531518-fe80-41cd-931b-0b96e311fcb7</Id>
    <Version>1.0.0.0</Version>
    <ProviderName>Lnnrp</ProviderName>
    <DefaultLocale>en-US</DefaultLocale>

    <DisplayName DefaultValue="Birthday Age Add-In"/>
    <Description DefaultValue="Generate birthday events with ages."/>
    <IconUrl DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-64.png"/>
    <HighResolutionIconUrl DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-128.png"/>

    <Hosts>
        <Host Name="Mailbox"/>
    </Hosts>

    <Requirements>
        <Sets>
            <Set Name="Mailbox" MinVersion="1.1"/>
        </Sets>
    </Requirements>

    <!-- REQUIRED -->
    <FormSettings>
        <Form xsi:type="ItemRead">
            <DesktopSettings>
                <SourceLocation DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/dist/taskpane/taskpane.html"/>
                <RequestedHeight>250</RequestedHeight>
            </DesktopSettings>
        </Form>
    </FormSettings>

    <Permissions>ReadWriteMailbox</Permissions>

    <Rule xsi:type="RuleCollection" Mode="Or">
        <Rule xsi:type="ItemIs" ItemType="Appointment" FormType="Read"/>
    </Rule>

    <DisableEntityHighlighting>false</DisableEntityHighlighting>

    <!-- ================= VERSION OVERRIDES ================= -->
    <mailappor:VersionOverrides xsi:type="mailappor:VersionOverridesV1_0">

        <mailappor:Hosts>
            <mailappor:Host xsi:type="mailappor:MailHost">
                <mailappor:DesktopFormFactor>

                    <mailappor:FunctionFile resid="Commands.Url"/>

                    <!-- Appears when YOU open a calendar event -->
                    <mailappor:ExtensionPoint xsi:type="mailappor:AppointmentOrganizerCommandSurface">
                        <mailappor:OfficeTab id="TabDefault">

                            <mailappor:Group id="birthdayGroup">
                                <mailappor:Label resid="GroupLabel"/>

                                <mailappor:Control xsi:type="mailappor:Button" id="generateButton">
                                    <mailappor:Label resid="GenerateButton.Label"/>
                                    <mailappor:Icon>
                                        <bt:Image size="16" resid="Icon.16x16"/>
                                        <bt:Image size="32" resid="Icon.32x32"/>
                                        <bt:Image size="80" resid="Icon.80x80"/>
                                    </mailappor:Icon>
                                    <mailappor:Action xsi:type="mailappor:ExecuteFunction">
                                        <mailappor:FunctionName>generateBirthdays</mailappor:FunctionName>
                                    </mailappor:Action>
                                </mailappor:Control>

                            </mailappor:Group>

                        </mailappor:OfficeTab>
                    </mailappor:ExtensionPoint>

                </mailappor:DesktopFormFactor>
            </mailappor:Host>
        </mailappor:Hosts>

        <mailappor:Resources>

            <bt:Images>
                <bt:Image id="Icon.16x16" DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-16.png"/>
                <bt:Image id="Icon.32x32" DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-32.png"/>
                <bt:Image id="Icon.80x80" DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-80.png"/>
            </bt:Images>

            <bt:Urls>
                <bt:Url id="Commands.Url"
                        DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/dist/commands/commands.html"/>
            </bt:Urls>

            <bt:ShortStrings>
                <bt:String id="GroupLabel" DefaultValue="Birthday Add-in"/>
                <bt:String id="GenerateButton.Label" DefaultValue="Generate Birthdays"/>
            </bt:ShortStrings>

            <bt:LongStrings>
                <bt:String id="GenerateButton.Tooltip"
                           DefaultValue="Create birthday events for the current year"/>
            </bt:LongStrings>

        </mailappor:Resources>

    </mailappor:VersionOverrides>

</OfficeApp>
