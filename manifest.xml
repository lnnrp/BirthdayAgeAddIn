<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<OfficeApp xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xmlns:bt="http://schemas.microsoft.com/office/officeappbasictypes/1.0"
           xmlns="http://schemas.microsoft.com/office/appforoffice/1.1"
           xsi:type="MailApp">

    <Id>c8531518-fe80-41cd-931b-0b96e311fcb7</Id>
    <Version>1.0.0.0</Version>
    <ProviderName>Lnnrp</ProviderName>
    <DefaultLocale>en-US</DefaultLocale>

    <DisplayName DefaultValue="Birthday Age Add-In"/>
    <Description DefaultValue="Generates birthdays with ages on your calendar."/>

    <IconUrl DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-64.png"/>
    <HighResolutionIconUrl DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-128.png"/>

    <SupportUrl DefaultValue="https://www.contoso.com/help"/>

    <AppDomains>
        <AppDomain>https://lnnrp.github.io</AppDomain>
    </AppDomains>

    <Hosts>
        <Host Name="Mailbox"/>
    </Hosts>

    <Requirements>
        <Sets>
            <Set Name="Mailbox" MinVersion="1.1"/>
        </Sets>
    </Requirements>

    <FormSettings>
        <Form xsi:type="ItemRead">
            <DesktopSettings>
                <SourceLocation DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/simple/taskpane/taskpane.html"/>
                <RequestedHeight>250</RequestedHeight>
            </DesktopSettings>
        </Form>
    </FormSettings>

    <!-- REQUIRED for Graph calendar + contacts -->
    <Permissions>ReadWriteMailbox</Permissions>

    <Rule xsi:type="RuleCollection" Mode="Or">
        <Rule xsi:type="ItemIs" ItemType="Message" FormType="Read"/>
    </Rule>

    <DisableEntityHighlighting>false</DisableEntityHighlighting>

    <!-- ================= VERSION OVERRIDES ================= -->
    <VersionOverrides xmlns="http://schemas.microsoft.com/office/mailappversionoverrides"
                      xsi:type="VersionOverridesV1_0">

        <Requirements>
            <bt:Sets DefaultMinVersion="1.3">
                <bt:Set Name="Mailbox"/>
            </bt:Sets>
        </Requirements>

        <Hosts>
            <Host xsi:type="MailHost">
                <DesktopFormFactor>

                    <ExtensionPoint xsi:type="MessageReadCommandSurface">
                        <OfficeTab id="TabDefault">
                            <Group id="birthdayAddinGroup">
                                <Label resid="GroupLabel"/>

                                <Control xsi:type="Button" id="generateButton">
                                    <Label resid="GenerateButton.Label"/>
                                    <Supertip>
                                        <Title resid="GenerateButton.Label"/>
                                        <Description resid="GenerateButton.Tooltip"/>
                                    </Supertip>
                                    <Icon>
                                        <bt:Image size="16" resid="Icon.16x16"/>
                                        <bt:Image size="32" resid="Icon.32x32"/>
                                        <bt:Image size="80" resid="Icon.80x80"/>
                                    </Icon>
                                    <Action xsi:type="ShowTaskpane">
                                        <SourceLocation resid="Taskpane.Url"/>
                                    </Action>
                                </Control>

                            </Group>
                        </OfficeTab>
                    </ExtensionPoint>

                </DesktopFormFactor>
            </Host>
        </Hosts>

        <!-- ðŸ”‘ REQUIRED FOR getAccessToken + Graph -->
        <WebApplicationInfo>
            <Id>bd90bbcf-83d5-4857-869f-3c19df412c0d</Id>
            <Resource>https://graph.microsoft.com</Resource>
            <Scopes>
                <Scope>Contacts.Read</Scope>
                <Scope>Calendars.ReadWrite</Scope>
            </Scopes>
        </WebApplicationInfo>

        <Resources>
            <bt:Images>
                <bt:Image id="Icon.16x16" DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-16.png"/>
                <bt:Image id="Icon.32x32" DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-32.png"/>
                <bt:Image id="Icon.80x80" DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/assets/icon-80.png"/>
            </bt:Images>

            <bt:Urls>
                <bt:Url id="Taskpane.Url"
                        DefaultValue="https://lnnrp.github.io/BirthdayAgeAddIn/simple/taskpane/taskpane.html"/>
            </bt:Urls>

            <bt:ShortStrings>
                <bt:String id="GroupLabel" DefaultValue="Birthday Add-in"/>
                <bt:String id="GenerateButton.Label" DefaultValue="Generate Birthdays"/>
            </bt:ShortStrings>

            <bt:LongStrings>
                <bt:String id="GenerateButton.Tooltip"
                           DefaultValue="Create birthday events for this year."/>
            </bt:LongStrings>
        </Resources>

    </VersionOverrides>
</OfficeApp>
